<html>
<head>
  <link rel="stylesheet" href="./dist/talkie.min.css">
  <link rel="stylesheet" href="./dist/talkie-default.min.css">
  <link rel="stylesheet" href="./style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/monokai_sublime.min.css">
</head>
<body>

<script layout type="text/x-markdown">
## 10章
### セキュリティ:
### ブラウザを守るHTTPの機能
</script>

<script layout type="text/x-markdown">
#### 本章で学ぶこと
* 一般的なセキュリティ事案に対して、発生原因・対策方法・ブラウザがどのようにして攻撃を阻止しようとしているかを紹介する
</script>

<script layout type="text/x-markdown">
### 10.1 従来型の攻撃
</script>

<script layout type="text/x-markdown">
* 従来型 = ブラウザを狙った攻撃以外の意味 (本の筆者が独自に使ってる)
* 増殖の仕方や目的によっていくつかに分類される
* 現在でも使われる手口のため、Webサービスの開発者にとっても脅威であることは変わりない
</script>

<script layout type="text/x-markdown">
### 10.2 ブラウザを狙う攻撃の特徴
</script>

<script layout type="text/x-markdown">
* ブラウザは他のサービスに繋がった「窓」である
* ブラウザの脆弱性だけでなく、サービスが返すHTMLやJSの脆弱性も標的にある
* 通信ログを見て不正なアクセスがないか確認するなどの対応が必要になる
</script>

<script layout type="text/x-markdown">
* ユーザー固有のコンテンツへの通行手形として利用される鍵の役割を持つ名称
* ・ セッショントークン
* ・ セッションクッキー
* ・ セッションキー
* ・ セッションID
* ・ アクセストークン
</script>

<script layout type="text/x-markdown">
### 10.3 クロスサイトスクリプティング (XSS)
</script>

<script layout type="text/x-markdown">
* ユーザーが入力した内容を何もフィルタリングせずに公開する、というのが発生しやすいシナリオ
* 防衛方法としては、サニタイズをしてHTMLを適切なエスケープをする
</script>

<script layout type="text/x-markdown">
### 10.3.1 漏洩を防ぐためのクッキーの設定
</script>

<script layout type="text/x-markdown">
* `httpOnly` 属性を付与して、JSからアクセスできないようにする
* XSSの攻撃者はJSを使うため、httpOnly属性によってセッショントークン漏洩の危険を減らすことができる
</script>

<script layout type="text/x-markdown">
### 10.3.2 X-XSS-Protectionヘッダー
</script>

<script layout type="text/x-markdown">
* HTMLのインラインでスクリプトタグを使っているケースなど、明らかに怪しいパターンを検出する
* ただし、単なるパターンマッチのため、偽陽性(問題がないのに、問題とされてしまう)となる可能性がある
* `X-`の非公式ヘッダーだが、IE, Chrome, Safariなどで対応 (FirefoxはCSPで対応すればいいというスタンスのため非対応)
* 設定例 `X-XSS-Protection: 1; mode=block`
</script>

<script layout type="text/x-markdown">
### 10.3.3 Content-Security-Policyヘッダー
</script>

<script layout type="text/x-markdown">
* Webサイトで使える機能を細かくON/OFFできる仕組み
* 10種類以上のディレクティブが定義されており、これらは大きく4つに分類できる
* ・ リソースファイルのアクセス権を設定するディレクティブ
* ・ CSPでリソースに対してい設定できるデータ属性
* ・ リソース以外のCSP設定
* ・ 一括でセキュリティを向上させるディレクティブ
* 段階的に移行するための機構として、チェックは行うが動作は継続する、 `Content-Security-Policy-Report-Only`ヘッダーがある
</script>使い

<script layout type="text/x-markdown">
### 10.3.4 Content-Security-PolicyとJavaScript製テンプレートエンジン
</script>

<script layout type="text/x-markdown">
* クライアントサイドのHTMLのテンプレートはCSPの設定によっては使用できない
* e.g. 実行時に`new Function`を使って関数を動的生成するため、unsafe-evalを許可してないと動かない
* JSのテンプレートエンジンではこれを回避するために、プリコンパイルを前提にしたバージョンがある場合もあるので、用途に合わせて使い分ける
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script layout type="text/x-markdown">
### 10.
</script>

<script layout type="text/x-markdown">
*
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
<script src="./dist/talkie.min.js"></script>
<script>Talkie();</script>
</body>
</html>
